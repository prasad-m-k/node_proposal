<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI RFP Proposal Generator</title>
    <link rel="stylesheet" href="/common.css">
    <link id="themeStylesheet" rel="stylesheet" href="/bright.css">
    <script>
        (function() {
            try {
                const savedTheme = localStorage.getItem('preferredTheme') || 'bright';
                window.__preferredTheme = savedTheme;
                const stylesheet = document.getElementById('themeStylesheet');
                if (stylesheet) {
                    stylesheet.href = savedTheme === 'dark' ? '/dark.css' : '/bright.css';
                }
            } catch (error) {
                console.error('Theme preload error:', error);
            }
        })();
    </script>
</head>
<body class="theme-bright app-page">
    <!-- Top Header Bar -->
    <header class="top-header">
        <div class="header-nav">
            <button class="back-btn" onclick="goBack()">‚Üê</button>
            <div class="page-title">AI RFP Proposal Generator</div>
            <button class="menu-btn">‚ò∞</button>
        </div>
        <div class="header-actions">
            <div class="user-info">
                <div class="user-avatar" id="userAvatar">U</div>
                <span id="username">Loading...</span>
            </div>
            <button class="theme-toggle" id="themeToggle">üåô</button>
            <a href="/profile" class="profile-btn">Profile</a>
            <button class="logout-btn" onclick="logout()">Logout</button>
        </div>
    </header>

    <!-- Main Layout Container -->
    <main class="layout-container">
        <!-- Left Panel -->
        <aside class="left-panel" id="leftPanel">
            <div class="panel-header">
                <h2>Proposals</h2>
                <button id="newProposalBtn" class="btn-create-proposal" type="button">+ New</button>
            </div>
            <div class="panel-content">
                <div id="proposalError" class="proposal-message" role="alert" aria-live="polite"></div>
                <div id="proposalTree" class="proposal-tree" role="tree"></div>
            </div>
        </aside>

        <!-- Resize Handle -->
        <div class="resize-handle" id="resizeHandle">
            <div class="resize-grip"></div>
        </div>

        <!-- Right Panel -->
        <section class="right-panel" id="rightPanel">
            <div class="home-flow" id="homeContent">
                <div class="hero-section">
                    <div class="hero-content">
                        <h1 class="hero-title">AI RFP Proposal Generator</h1>
                        <p class="hero-subtitle">
                            Generate professional, comprehensive RFP proposals using artificial intelligence.
                            Create winning proposals quickly and efficiently with our intelligent platform.
                        </p>
                    </div>
                    <div class="hero-visual">
                        <div class="floating-element element-1"></div>
                        <div class="floating-element element-2"></div>
                        <div class="floating-element element-3"></div>
                    </div>
                </div>

                <div class="features-flow">
                    <div class="feature-bubble large">
                        <div class="feature-icon">üß†</div>
                        <h3>Smart Analysis</h3>
                        <p>AI-powered analysis of RFP requirements to ensure comprehensive proposal coverage.</p>
                    </div>

                    <div class="feature-bubble medium">
                        <div class="feature-icon">üìö</div>
                        <h3>Template Library</h3>
                        <p>Access to professional proposal templates tailored for different industries.</p>
                    </div>

                    <div class="feature-bubble small">
                        <div class="feature-icon">üë•</div>
                        <h3>Collaboration</h3>
                        <p>Work with your team in real-time to create and refine proposals.</p>
                    </div>

                    <div class="feature-bubble medium">
                        <div class="feature-icon">üìÑ</div>
                        <h3>Export Options</h3>
                        <p>Export in multiple formats including PDF, Word, and presentation slides.</p>
                    </div>
                </div>
            </div>

            <section class="work-area" id="workArea" hidden>
                <div class="work-area-header">
                    <div>
                        <h2 id="activeProposalName">Select a proposal to get started</h2>
                        <p id="activeProposalSubtitle">Choose a proposal on the left to walk through the workflow.</p>
                    </div>
                </div>

                <div class="workflow-container" id="workflowContainer">
                    <!-- Tab Navigation -->
                    <nav class="workflow-tabs" id="workflowTabs">
                        <button class="workflow-tab active" data-step="1" id="tab-step-1">
                            <div class="tab-number">1</div>
                            <div class="tab-title">Upload RFP Document</div>
                        </button>
                        <button class="workflow-tab" data-step="2" id="tab-step-2" disabled>
                            <div class="tab-number">2</div>
                            <div class="tab-title">Upload Organization Details</div>
                        </button>
                        <button class="workflow-tab" data-step="3" id="tab-step-3" disabled>
                            <div class="tab-number">3</div>
                            <div class="tab-title">Draft Solution Outline</div>
                        </button>
                        <button class="workflow-tab" data-step="4" id="tab-step-4" disabled>
                            <div class="tab-number">4</div>
                            <div class="tab-title">Review & Finalize</div>
                        </button>
                    </nav>

                    <!-- Tab Content -->
                    <div class="workflow-content">
                        <article class="workflow-step active" id="step-upload" data-step="1">
                            <h3>Step 1 ¬∑ Upload RFP Document</h3>
                            <p>Upload the client RFP. We will analyze the content with Gemini 2.0 Flash, explicitly prompting it to avoid hallucinations, and generate structured artifacts for downstream automation.</p>

                            <div class="file-upload">
                                <label class="file-upload-label">
                                    <input type="file" id="rfpUpload" accept=".pdf,.doc,.docx,.txt,.md,.rtf">
                                    Upload Document
                                </label>
                                <small>Supported formats: PDF, Word, TXT, Markdown, RTF.</small>
                                <div id="uploadStatus" class="upload-status"></div>
                            </div>

                            <div class="step-action">
                                <button type="button" id="processRfpBtn" class="btn-primary" disabled>Analyze with Gemini</button>
                            </div>

                            <div id="generatedArtifacts" class="generated-artifacts" hidden>
                                <h4>Generated Artifacts</h4>
                                <ul class="artifact-list" id="artifactList"></ul>
                            </div>
                        </article>

                        <article class="workflow-step" id="step-org" data-step="2">
                            <h3>Step 2 ¬∑ Upload Organization Details</h3>
                            <p>Provide your company profile, relevant case studies, and reusable assets for proposal assembly.</p>
                            <div class="step-action">
                                <button type="button" class="btn-secondary" disabled>Upload Details (Coming Soon)</button>
                            </div>
                        </article>

                        <article class="workflow-step" id="step-outline" data-step="3">
                            <h3>Step 3 ¬∑ Draft Solution Outline</h3>
                            <p>Leverage AI-generated insights to build a compelling solution narrative tailored to the RFP.</p>
                            <div class="step-action">
                                <button type="button" class="btn-secondary" disabled>Generate Outline (Coming Soon)</button>
                            </div>
                        </article>

                        <article class="workflow-step" id="step-review" data-step="4">
                            <h3>Step 4 ¬∑ Review & Finalize</h3>
                            <p>Validate all deliverables, collaborate with stakeholders, and prepare the final submission package.</p>
                            <div class="step-action">
                                <button type="button" class="btn-secondary" disabled>Review Checklist (Coming Soon)</button>
                            </div>
                        </article>
                    </div>
                </div>
            </section>
        </section>
    </main>

    <script type="module" src="/js/index.js"></script>
</body>
</html>
