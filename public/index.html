<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI RFP Proposal Generator</title>
    <link id="themeStylesheet" rel="stylesheet" href="/bright.css">
    <script>
        (function() {
            try {
                const savedTheme = localStorage.getItem('preferredTheme') || 'bright';
                window.__preferredTheme = savedTheme;
                const stylesheet = document.getElementById('themeStylesheet');
                if (stylesheet) {
                    stylesheet.href = savedTheme === 'dark' ? '/dark.css' : '/bright.css';
                }
            } catch (error) {
                console.error('Theme preload error:', error);
            }
        })();
    </script>
</head>
<body class="theme-bright app-page">
    <header class="header">
        <div class="header-content">
            <div class="logo">AI RFP Proposal Generator</div>
            <div class="user-section">
                <div class="user-info">
                    <div class="user-avatar" id="userAvatar">U</div>
                    <span id="username">Loading...</span>
                </div>
                <a href="/profile" class="profile-btn">Edit Profile</a>
                <button class="logout-btn" onclick="logout()">Logout</button>
            </div>
        </div>
    </header>

    <main class="dashboard-main">
        <aside class="proposal-pane" aria-label="Proposal tasks">
            <div class="pane-header">
                <div>
                    <h2>Proposal Tasks</h2>
                    <p class="pane-subtitle">Each proposal tracks four key steps from RFP intake to final review.</p>
                </div>
                <div class="pane-controls">
                    <button id="collapsePaneBtn" class="pane-toggle" type="button" aria-expanded="true" aria-label="Collapse proposal pane">⟨</button>
                    <button id="newProposalBtn" class="btn-create-proposal" type="button">+ New</button>
                </div>
            </div>
            <div id="proposalError" class="proposal-message" role="alert" aria-live="polite"></div>
            <div id="proposalTree" class="proposal-tree" role="tree"></div>
        </aside>

        <div class="resize-handle" id="resizeHandle"></div>

        <section class="content-area" id="contentArea">
            <section class="home-content" id="homeContent">
                <section class="welcome-section">
                    <h1>Welcome to AI RFP Proposal Generator</h1>
                    <p>
                        Generate professional, comprehensive RFP proposals using artificial intelligence.
                        Our platform helps you create winning proposals quickly and efficiently.
                    </p>
                </section>

                <div class="features-grid">
                    <div class="feature-card">
                        <h3>Smart Analysis</h3>
                        <p>AI-powered analysis of RFP requirements to ensure comprehensive proposal coverage.</p>
                    </div>

                    <div class="feature-card">
                        <h3>Template Library</h3>
                        <p>Access to professional proposal templates tailored for different industries and sectors.</p>
                    </div>

                    <div class="feature-card">
                        <h3>Collaboration Tools</h3>
                        <p>Work with your team in real-time to create and refine proposals collaboratively.</p>
                    </div>

                    <div class="feature-card">
                        <h3>Export Options</h3>
                        <p>Export your proposals in multiple formats including PDF, Word, and presentation slides.</p>
                    </div>
                </div>
            </section>

            <section class="work-area" id="workArea" hidden>
                <div class="work-area-header">
                    <div>
                        <h2 id="activeProposalName">Select a proposal to get started</h2>
                        <p id="activeProposalSubtitle">Choose a proposal on the left to walk through the workflow.</p>
                    </div>
                </div>

                <div class="workflow-container" id="workflowContainer">
                    <!-- Tab Navigation -->
                    <nav class="workflow-tabs" id="workflowTabs">
                        <button class="workflow-tab active" data-step="1" id="tab-step-1">
                            <div class="tab-number">1</div>
                            <div class="tab-title">Upload RFP Document</div>
                        </button>
                        <button class="workflow-tab" data-step="2" id="tab-step-2" disabled>
                            <div class="tab-number">2</div>
                            <div class="tab-title">Upload Organization Details</div>
                        </button>
                        <button class="workflow-tab" data-step="3" id="tab-step-3" disabled>
                            <div class="tab-number">3</div>
                            <div class="tab-title">Draft Solution Outline</div>
                        </button>
                        <button class="workflow-tab" data-step="4" id="tab-step-4" disabled>
                            <div class="tab-number">4</div>
                            <div class="tab-title">Review & Finalize</div>
                        </button>
                    </nav>

                    <!-- Tab Content -->
                    <div class="workflow-content">
                        <article class="workflow-step active" id="step-upload" data-step="1">
                            <h3>Step 1 · Upload RFP Document</h3>
                            <p>Upload the client RFP. We will analyze the content with Gemini 2.0 Flash, explicitly prompting it to avoid hallucinations, and generate structured artifacts for downstream automation.</p>

                            <div class="file-upload">
                                <label class="file-upload-label">
                                    <input type="file" id="rfpUpload" accept=".pdf,.doc,.docx,.txt,.md,.rtf">
                                    Upload Document
                                </label>
                                <small>Supported formats: PDF, Word, TXT, Markdown, RTF.</small>
                                <div id="uploadStatus" class="upload-status"></div>
                            </div>

                            <div class="step-action">
                                <button type="button" id="processRfpBtn" class="btn-primary" disabled>Analyze with Gemini</button>
                            </div>

                            <div id="generatedArtifacts" class="generated-artifacts" hidden>
                                <h4>Generated Artifacts</h4>
                                <ul class="artifact-list" id="artifactList"></ul>
                            </div>
                        </article>

                        <article class="workflow-step" id="step-org" data-step="2">
                            <h3>Step 2 · Upload Organization Details</h3>
                            <p>Provide your company profile, relevant case studies, and reusable assets for proposal assembly.</p>
                            <div class="step-action">
                                <button type="button" class="btn-secondary" disabled>Upload Details (Coming Soon)</button>
                            </div>
                        </article>

                        <article class="workflow-step" id="step-outline" data-step="3">
                            <h3>Step 3 · Draft Solution Outline</h3>
                            <p>Leverage AI-generated insights to build a compelling solution narrative tailored to the RFP.</p>
                            <div class="step-action">
                                <button type="button" class="btn-secondary" disabled>Generate Outline (Coming Soon)</button>
                            </div>
                        </article>

                        <article class="workflow-step" id="step-review" data-step="4">
                            <h3>Step 4 · Review & Finalize</h3>
                            <p>Validate all deliverables, collaborate with stakeholders, and prepare the final submission package.</p>
                            <div class="step-action">
                                <button type="button" class="btn-secondary" disabled>Review Checklist (Coming Soon)</button>
                            </div>
                        </article>
                    </div>
                </div>
            </section>
        </section>
    </main>

    <script type="module" src="/js/index.js"></script>
</body>
</html>
